# Pressure advance

В этом документе содержится информация о настройке переменной конфигурации "повышение давления" для конкретного сопла и нити накала. Функция повышения давления может быть полезна для уменьшения количества вытекания. Для получения дополнительной информации о том, как реализуется повышение давления, см. раздел [кинематика](Kinematics.md) документ.

## Tuning pressure advance

Повышение давления делает две полезные вещи - оно уменьшает выделение жидкости во время движений без выдавливания и уменьшает образование капель во время поворотов. В этом руководстве используется вторая функция (уменьшение сгущения во время поворотов) в качестве механизма настройки.

Для предварительной калибровки давления принтер должен быть сконфигурирован и работать, поскольку проверка настройки включает печать и проверку объекта тестирования. Рекомендуется прочитать этот документ полностью перед запуском теста.

Используйте слайсер для создания g-кода большого пустотелого квадрата, найденного в [docs/prints/square_tower.still](https://github.com/KevinOConnor/klipper/tree/master/docs/prints/square_tower.stl). Используйте высокую скорость (например, 100 мм/с), нулевое заполнение и высоту грубого слоя (высота слоя должна составлять около 75% диаметра сопла). Убедитесь, что в срезе отключено любое "управление динамическим ускорением".

Подготовьтесь к тесту, выполнив следующую команду G-кода:
```
SET_VELOCITY_LIMIT SQUARE_CORNER_VELOCITY=1 ACCEL=500
```
Эта команда замедляет перемещение сопла по углам, чтобы подчеркнуть влияние давления экструдера. Затем для принтеров с директ-экструдером выполните команду:
```
TUNING_TOWER COMMAND=SET_PRESSURE_ADVANCE PARAMETER=ADVANCE START=0 FACTOR=.005
```
Для боуден-экструдеров используйте эту команду:
```
TUNING_TOWER COMMAND=SET_PRESSURE_ADVANCE PARAMETER=ADVANCE START=0 FACTOR=.020
```
Затем распечатайте объект. При полной печати тестовый отпечаток выглядит следующим образом:

![tuning_tower](https://github.com/KevinOConnor/klipper/tree/master/docs/img/tuning_tower.jpg)

Приведенная выше команда TUNING_TOWER указывает Клипперу изменить настройку pressure_advance на каждом слое печати. Более высокие слои печати будут иметь большее значение опережения давления. Слои ниже идеальной настройки pressure_advance будут иметь сгустки по углам, а слои выше идеальной настройки могут привести к закруглению углов и плохой экструзии, ведущей к углу.

Можно отменить печать раньше, если вы заметите, что углы больше не печатаются хорошо (и, таким образом, можно избежать печати слоев, которые, как известно, превышают идеальное значение pressure_advance).

Проверьте печать, а затем используйте цифровой штангенциркуль, чтобы найти высоту, которая имеет углы наилучшего качества. Если вы сомневаетесь, предпочитайте более низкий рост.

![tune_pa](https://github.com/KevinOConnor/klipper/tree/master/docs/img/tune_pa.jpg)

Значение pressure_advance затем может быть рассчитано как  `pressure_advance = <start> + <measured_height> * <factor>`. (Например, `0 + 12.90 * .020` будет `.258`.)

Можно выбрать пользовательские настройки для START и FACTOR, если это поможет определить наилучшую настройку опережения давления. При этом обязательно выполняйте команду TUNING_TOWER в начале каждой тестовой печати.

Типичные значения опережения давления находятся в диапазоне от 0,050 до 1,000 (высокое значение обычно только для боуден-экструдеров ). Если нет существенного улучшения при повышении давления до 1000, то повышение давления вряд ли улучшит качество отпечатков. Вернитесь к конфигурации по умолчанию с отключенным повышением давления.

Хотя это упражнение по настройке напрямую улучшает качество углов, стоит помнить, что хорошая конфигурация повышения давления также уменьшает просачивание по всей печати.

По завершении этого теста установите `pressure_advance = <calculated_value>` в разделе `[extruder]` файла конфигурации и выполните команду RESTART. Команда RESTART очистит тестовое состояние и вернет ускорение и скорость на поворотах к их нормальным значениям.

## Важные примечания

* Значение опережения давления зависит от экструдера, сопла и филамента. Для филамента разных производителей или с разными пигментами обычно требуются значительно разные значения опережения давления. Поэтому следует заранее откалибровать давление на каждом принтере и с каждой катушкой пластика.

* Температура печати и скорость экструзии могут повлиять на повышение давления. Обязательно настройте [сопротивление вращению экструдера](Rotation_Distance.md#calibrating-rotation_distance-on-extruders) и [температуру сопла](http://reprap.org/wiki/Triffid_Hunter%27s_Calibration_Guide#Nozzle_Temperature) до предварительной настройки давления.
 
* Тестовая печать предназначена для работы с высокой скоростью потока экструдера, но в остальном использует "нормальные" настройки слайсера. Высокая скорость потока достигается за счет использования высокой скорости печати (например, 100 мм/с) и высоты грубого слоя (обычно около 75% диаметра сопла). Другие настройки слайсера должны быть аналогичны настройкам по умолчанию (например, периметры 2 или 3 линий, нормальная величина втягивания). Может быть полезно установить скорость внешнего периметра такой же, как и для остальной части печати, но это не является обязательным требованием.

* Обычно тестовая печать показывает разное поведение на каждом углу. Часто слайсер организует смену слоев в одном углу, что может привести к тому, что этот угол будет значительно отличаться от остальных трех углов. Если это произойдет, то проигнорируйте этот угол и настройте давление заранее, используя остальные три угла. Также часто бывает, что остальные углы немного различаются. (Это может произойти из-за небольших различий в том, как рамка принтера реагирует на повороты в определенных направлениях.) Попробуйте выбрать значение, которое хорошо работает для всех остальных углов. Если вы сомневаетесь, предпочтите более низкое
значение опережения давления.

* Если используется значение опережения высокого давления (например, более 0,200), то можно обнаружить, что экструдер пропускает при возвращении к нормальному ускорению принтера. Система повышения давления учитывает давление, вдавливая дополнительную нить накала во время ускорения и втягивая эту нить во время замедления. При высоком ускорении и повышении давления экструдеру может не хватить крутящего момента для выталкивания необходимой нити накала. В этом случае либо используйте меньшее значение ускорения, либо отключите повышение давления.

* После настройки повышения давления в Klipper все еще может быть полезно настроить небольшое значение втягивания в слайсере (например, 0,75 мм) и использовать опцию "протирать при втягивании" слайсера, если она доступна. Эти настройки слайсера могут помочь противодействовать выделению пластика, вызванному сцеплением нити (нить, выдернутая из сопла из-за липкости пластика). Рекомендуется отключить опцию "z-подъем при втягивании" слайсера.

* Система повышения давления не изменяет время или траекторию движения инструментальной головки. Печать с включенным повышением давления займет столько же времени, сколько и печать без повышения давления. Повышение давления также не влияет на общее количество нити, выдавливаемой во время печати. Повышение давления приводит к дополнительному перемещению экструдера во время ускорения и замедления движения. Установка опережения очень высокого давления приведет к очень большому перемещению экструдера во время ускорения и замедления, и никакие настройки конфигурации не ограничивают величину этого перемещения.
